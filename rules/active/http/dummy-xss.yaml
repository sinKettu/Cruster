# Config example will be here
metadata:
  authors:
    - sinKettu<avangard.jazz@gmail.com>
  name: Dummy XSS
  references: []
  tags:
    - test
    - xss
severity: info
id: dummy-xss-test
rule:
  type: active
  protocol: http
  watch:
    - id: query-watch
      part: path
      # Regex for query values
      paattern: '=(?P<qv>[^=&$]+)(&|$)'
  change:
    - id: change-after
      placement: after
      watch_id: query-watch::qv
      values:
        - <script>alert(1)</script>
        - \'<script>alert(1)</script>
    - id: change-replace
      placement: replace
      watch_id: query-watch::qv
      values:
        - <script>alert(1)</script>
        - \'<script>alert(1)</script>
  send:
    - apply:
        - change-after
      repeat: 0
      timeout_after: 0
    - apply:
        - change-replace
      repeat: 0
      timeout_after: 0
  find:
    - look_for: any
      part: response
      # id 0 is always owned by initial request/response pair
      send_id: 1
      expressions:
        - regex_search(body, '<script>alert(1)</script>')
