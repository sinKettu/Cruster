metadata:
  about: Example of rule to detect DVNA web app.
  authors:
    - sinKettu<avangard.jazz@gmail.com>
  name: 'Detect DVNA'
  references: 
    - https://github.com/appsecco/dvna
  tags:
    - example
    - dvna
severity: info
id: detect-dvna
rule:
  http:
    passive:
      find:
        - id: detected
          exec:
            - operation: rematch
              name: match_name
              args:
                - type: string
                  value: "<title>Damn Vulnerable NodeJS Application</title>"
                - type: reference
                  value: initial.response.body
            - operation: rematch
              name: match_path
              args:
                - type: string
                  value: /learn$
                - type: reference
                  value: initial.request.path
            - operation: and
              name: condition
              args:
                - type: variable
                  value: match_name
                - type: variable
                  value: match_path
